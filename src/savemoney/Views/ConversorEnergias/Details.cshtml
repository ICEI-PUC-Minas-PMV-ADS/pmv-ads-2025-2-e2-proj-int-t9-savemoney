@model savemoney.Models.ConversorEnergia

@{
    ViewData["Title"] = "Detalhes da Conversão";
    string dica = ViewBag.Dica;
    string tarifa = ViewBag.Tarifa;
}

@section css {
    <link rel="stylesheet" href="~/css/conversor.css" asp-append-version="true" />
}

<div class="conversor-details-main fade-in">

    <!-- Cabeçalho -->
    <header class="details-header">
        <h1 class="page-title">
            <i class="bi bi-graph-up" aria-hidden="true"></i>
            Análise da Conversão
        </h1>
    </header>

    <!-- Resultados principais -->
    <div class="results-panel glass-panel">
        <div class="results-grid">
            <!-- Consumo -->
            <div class="result-card result-success">
                <span class="result-label">CONSUMO MENSAL</span>
                <strong class="result-value">@Model.ConsumoMensal?.ToString("F2") kWh</strong>
                <span class="result-description">@Model.TipoDispositivo usado @Model.TempoUso h/dia</span>
            </div>

            <!-- Custo -->
            <div class="result-card result-danger">
                <span class="result-label">CUSTO MENSAL ESTIMADO</span>
                <strong class="result-value">@Model.CustoMensal?.ToString("C")</strong>
                <span class="result-description">Tarifa final: @tarifa / kWh</span>
            </div>
        </div>

        <!-- Dica de economia -->
        @if (!string.IsNullOrEmpty(dica))
        {
            <div class="alert-tip" role="alert">
                <i class="bi bi-lightbulb-fill" aria-hidden="true"></i>
                <span>@Html.Raw(dica)</span>
            </div>
        }

        <!-- Dados de entrada -->
        <section aria-labelledby="input-data-title">
            <h2 id="input-data-title" class="section-title">Dados de Entrada</h2>

            <dl class="details-list">
                <div class="detail-row">
                    <dt>Valor Base e Unidade</dt>
                    <dd>@Model.ValorBase @Model.TipoValor</dd>
                </div>
                <div class="detail-row">
                    <dt>Tipo de Aparelho</dt>
                    <dd>@Model.TipoDispositivo</dd>
                </div>
                <div class="detail-row">
                    <dt>Tempo de Uso Diário</dt>
                    <dd>@Model.TempoUso horas/dia</dd>
                </div>
                <div class="detail-row">
                    <dt>Estado</dt>
                    <dd>@Model.Estado</dd>
                </div>
                <div class="detail-row">
                    <dt>Modalidade de Energia</dt>
                    <dd>@Model.Modalidade</dd>
                </div>
                <div class="detail-row">
                    <dt>Bandeira Tarifária</dt>
                    <dd>@Model.BandeiraTarifaria</dd>
                </div>
            </dl>

            <!-- Info adicional -->
            <div class="info-box">
                <h3>Como foi calculado?</h3>
                @if (Model.TipoValor == "Watts")
                {
                    <p>
                        <strong>Fórmula:</strong> (@Model.ValorBase W ÷ 1000) × @Model.TempoUso h/dia × 30 dias = @Model.ConsumoMensal?.ToString("F2") kWh/mês
                    </p>
                }
                else
                {
                    <p>
                        <strong>Fórmula:</strong> @Model.ValorBase R$ ÷ @tarifa/kWh = @Model.ConsumoMensal?.ToString("F2") kWh/mês
                    </p>
                }
            </div>
        </section>
    </div>

    <!-- Ações -->
    <div class="details-actions">
        <a asp-action="Index" class="btn-action btn-secondary">
            <i class="bi bi-arrow-left" aria-hidden="true"></i>
            Voltar ao Histórico
        </a>
        <button class="btn-action btn-primary"
                onclick="carregarModalEditar(@Model.Id)"
                aria-label="Editar dados da conversão">
            <i class="bi bi-pencil" aria-hidden="true"></i>
            Editar Dados
        </button>
    </div>
</div>

<!-- Container para modal -->
<div id="modal-container"></div>

@section Scripts {
    <script src="~/js/conversor.js" asp-append-version="true"></script>
}