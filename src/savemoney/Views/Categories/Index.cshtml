@model IEnumerable<savemoney.Models.Category>

@{
    ViewData["Title"] = "Categorias";
}

@section css {
    <link rel="stylesheet" href="~/css/categories.css" asp-append-version="true" />
}

<div class="categories-page-main fade-in">

    <!-- Cabeçalho -->
    <header class="page-header">
        <div class="header-content">
            <h1 class="page-title">Categorias</h1>
            <p class="page-subtitle">Gerencie as categorias das suas transações.</p>
        </div>
        <button class="btn-action btn-primary"
                onclick="carregarModalCriar()"
                aria-label="Criar nova categoria">
            <i class="bi bi-plus-lg" aria-hidden="true"></i>
            <span>Nova Categoria</span>
        </button>
    </header>

    <!-- Estado vazio -->
    @if (!Model.Any())
    {
        <div class="empty-state glass-panel">
            <div class="empty-icon" aria-hidden="true">
                <i class="bi bi-tags"></i>
            </div>
            <h2>Nenhuma categoria encontrada</h2>
            <p>Crie categorias para organizar suas receitas e despesas.</p>
            <button class="btn-action btn-secondary" onclick="carregarModalCriar()">
                Criar Primeira Categoria
            </button>
        </div>
    }
    else
    {
        <!-- Lista de categorias -->
        <div class="glass-panel">
            <ul class="categories-list" role="list">
                @foreach (var item in Model)
                {
                    <li class="category-item" role="listitem">
                        <div class="category-info">
                            <div class="category-icon" aria-hidden="true">
                                <i class="bi bi-tag-fill"></i>
                            </div>
                            <div class="category-details">
                                <h3 class="category-name">@item.Name</h3>
                                @if (item.IsPredefined)
                                {
                                    <span class="badge badge-system">Padrão do Sistema</span>
                                }
                            </div>
                        </div>

                        <div class="category-actions">
                            <button class="btn-icon"
                                    onclick="carregarModalEditar(@item.Id)"
                                    title="Editar categoria @item.Name"
                                    aria-label="Editar categoria @item.Name">
                                <i class="bi bi-pencil-fill" aria-hidden="true"></i>
                            </button>
                            @if (!item.IsPredefined)
                            {
                                <button class="btn-icon danger"
                                        onclick="confirmarExclusao(@item.Id)"
                                        title="Excluir categoria @item.Name"
                                        aria-label="Excluir categoria @item.Name">
                                    <i class="bi bi-trash-fill" aria-hidden="true"></i>
                                </button>
                            }
                        </div>
                    </li>
                }
            </ul>
        </div>
    }
</div>

<!-- Container para modais dinâmicos -->
<div id="modal-container"></div>

<!-- Modal de confirmação de exclusão -->
<div class="modal fade"
     id="deleteModal"
     tabindex="-1"
     aria-labelledby="deleteModalLabel"
     aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content glass-panel">
            <div class="modal-body text-center p-4">
                <div class="modal-icon-warning" aria-hidden="true">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                </div>
                <h2 id="deleteModalLabel" class="modal-title-warning">Excluir Categoria?</h2>
                <p class="modal-text-secondary">Essa ação não pode ser desfeita.</p>
                <div class="modal-actions">
                    <button type="button"
                            class="btn-action btn-secondary"
                            data-bs-dismiss="modal">
                        Cancelar
                    </button>
                    <button type="button"
                            class="btn-action btn-danger"
                            onclick="executarExclusao()">
                        Excluir
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/categories.js" asp-append-version="true"></script>
    <partial name="_ValidationScriptsPartial" />
}