@using System.Security.Claims

@{
    bool isLandingPage = (ViewData["Title"] as string) == "Save Money - Gestão Financeira Premium";
}

<header id="main-header">
    <div class="header-container">

        <a asp-controller="@(User.Identity.IsAuthenticated ? "Dashboard" : "LandingPage")" asp-action="Index" class="header-logo">
            Save Money
        </a>

        <nav class="header-nav">
            <ul class="header-nav-links">

                @if (isLandingPage)
                {
                    <li><a href="#control">Controle</a></li>
                    <li><a href="#invest">Investir</a></li>
                    <li class="header-dropdown">
                        <a href="#">Perfis <i class="bi bi-chevron-down"></i></a>
                        <ul class="header-dropdown-menu">
                            <li><a href="#profiles">Pessoa Física</a></li>
                            <li><a href="#profiles">Pessoa Jurídica</a></li>
                        </ul>
                    </li>
                    <li class="header-dropdown">
                        <a href="#">Relatórios <i class="bi bi-chevron-down"></i></a>
                        <ul class="header-dropdown-menu">
                            <li><a href="#reports">Diagnósticos</a></li>
                            <li><a href="#reports">Análise de Tendências</a></li>
                        </ul>
                    </li>
                    <li><a href="#goals">Metas</a></li>
                    <li><a href="#customize">Personalizar</a></li>
                }
                else
                {
                    <li><a asp-controller="Dashboard" asp-action="Index">Painel</a></li>

                    <li class="header-dropdown">
                        <a href="#">Gestão <i class="bi bi-chevron-down"></i></a>
                        <ul class="header-dropdown-menu">
                            <li><a asp-controller="Receitas" asp-action="Index">Receitas</a></li>
                            <li><a asp-controller="Despesas" asp-action="Index">Despesas</a></li>
                            <li><a asp-controller="Categories" asp-action="Index">Categorias</a></li>
                        </ul>
                    </li>

                    <li class="header-dropdown">
                        <a href="#">Estratégia <i class="bi bi-chevron-down"></i></a>
                        <ul class="header-dropdown-menu">
                            <li><a asp-controller="Budgets" asp-action="Index">Orçamentos</a></li>
                            <li><a asp-controller="MetasFinanceiras" asp-action="Index">Metas</a></li>
                            <li><hr class="dropdown-divider" style="border-color: rgba(255,255,255,0.1); margin: 0.5rem 0;"></li>
                            <li><a asp-controller="TendenciaFinanceira" asp-action="Index">Tendências</a></li>
                            <li><a asp-controller="ProjecaoFinanceira" asp-action="Index" style="color: #3b82f6;">Projeção Futura</a></li>
                        </ul>
                    </li>

                    <li class="header-dropdown">
                        <a href="#">Ferramentas <i class="bi bi-chevron-down"></i></a>
                        <ul class="header-dropdown-menu">
                            <li><a asp-controller="Ferramentas" asp-action="CalculadoraDeMetas">Calc. Metas</a></li>
                            <li><a asp-controller="Ferramentas" asp-action="CalculadoraDeEquilibrio">Ponto de Equilíbrio</a></li>
                            <li><a asp-controller="ConversorEnergias" asp-action="Index">Conversor Energia</a></li>
                        </ul>
                    </li>

                    <li><a asp-controller="EducacaoFinanceira" asp-action="Index">Educação</a></li>

                    @if (User.IsInRole("Administrador"))
                    {
                        <li><a asp-controller="Usuarios" asp-action="Index">Usuários</a></li>
                    }
                }
            </ul>
        </nav>

        <div class="header-actions">
            @if (User.Identity.IsAuthenticated)
            {
                var userId = User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier)?.Value;

                <a asp-controller="Usuarios" asp-action="Details" asp-route-id="@userId"
                   class="header-btn header-btn-icon" title="Meu Perfil">
                    <i class="bi bi-person-fill"></i>
                </a>

                @if (isLandingPage)
                {
                    <a asp-controller="Dashboard" asp-action="Index" class="header-btn header-btn-primary">Painel</a>
                }
                else
                {
                    <a asp-controller="Usuarios" asp-action="Logout" class="header-btn header-btn-primary">Sair</a>
                }
            }
            else
            {
                <a asp-controller="Usuarios" asp-action="Login" class="header-btn header-btn-primary">Entrar</a>
            }
        </div>

    </div>

    <button id="header-toggle-tab" class="header-toggle-tab" title="Alternar Menu">
        <i class="bi bi-chevron-up"></i>
    </button>
</header>