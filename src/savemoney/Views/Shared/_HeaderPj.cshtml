@using System.Security.Claims

<header id="main-header" class="header-pj-theme">
    <div class="header-container">

        <a asp-controller="Dashboard" asp-action="Index" class="header-logo" title="Painel">
            <i class="bi bi-building text-warning me-2"></i>SaveMoney
            <span class="badge bg-warning text-dark ms-2" style="font-size: 0.6rem; vertical-align: middle;">PJ</span>
        </a>

        <nav class="header-nav">
            <ul class="header-nav-links">
                <li><a asp-controller="Dashboard" asp-action="Index">Painel</a></li>

                <li class="header-dropdown">
                    <a href="#">Financeiro <i class="bi bi-chevron-down"></i></a>
                    <ul class="header-dropdown-menu">
                        <li><a asp-controller="Receitas" asp-action="Index">Faturamento</a></li>
                        <li><a asp-controller="Despesas" asp-action="Index">Contas a Pagar</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a asp-controller="Historico" asp-action="Index">Extrato</a></li>
                    </ul>
                </li>

                <li class="header-dropdown">
                    <a href="#" class="text-warning">Gestão <i class="bi bi-chevron-down"></i></a>
                    <ul class="header-dropdown-menu">
                        <li><a asp-controller="DreGerencial" asp-action="Index">DRE Gerencial</a></li>
                        <li><a asp-controller="ProjecaoFinanceira" asp-action="FluxoDeCaixa">Fluxo de Caixa</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a asp-controller="Relatorios" asp-action="Index">Relatórios</a></li>
                    </ul>
                </li>

                <li class="header-dropdown">
                    <a href="#">Contábil <i class="bi bi-chevron-down"></i></a>
                    <ul class="header-dropdown-menu">
                        <li><a asp-controller="Categories" asp-action="Index">Plano de Contas</a></li>
                        <li><a asp-controller="Budgets" asp-action="Index">Centros de Custo</a></li>
                    </ul>
                </li>

                <li class="header-dropdown">
                    <a href="#">Cálculos <i class="bi bi-chevron-down"></i></a>
                    <ul class="header-dropdown-menu">
                        <li><a asp-controller="Ferramentas" asp-action="CalculadoraDeEquilibrio">Ponto de Equilíbrio</a></li>
                        <li><a asp-controller="ConversorEnergias" asp-action="Index">Custo de Energia</a></li>
                    </ul>
                </li>

                @if (User.IsInRole("Administrador"))
                {
                    <li><a asp-controller="Usuarios" asp-action="Index" class="text-danger">Admin</a></li>
                }
            </ul>
        </nav>

        <div class="header-actions">
            @if (User.Identity != null && User.Identity.IsAuthenticated)
            {
                var userName = User.Identity.Name ?? "User";
                var initials = userName.Length >= 2 ? userName.Substring(0, 2).ToUpper() : userName.ToUpper();

                <div class="header-user-avatar header-user-avatar-pj" title="@userName">
                    <span>@initials</span>
                </div>
            }
        </div>

        <button class="header-mobile-toggle" id="mobile-menu-toggle" aria-label="Menu">
            <i class="bi bi-list"></i>
        </button>
    </div>

    <nav id="mobile-nav-drawer" class="mobile-nav-drawer">
        <ul class="mobile-nav-links">
            <li><a asp-controller="Dashboard" asp-action="Index" data-dismiss="mobile-nav">Painel</a></li>

            <li class="mobile-dropdown">
                <button class="mobile-dropdown-toggle">Financeiro <i class="bi bi-chevron-down"></i></button>
                <ul class="mobile-dropdown-menu">
                    <li><a asp-controller="Receitas" asp-action="Index" data-dismiss="mobile-nav">Faturamento</a></li>
                    <li><a asp-controller="Despesas" asp-action="Index" data-dismiss="mobile-nav">Contas a Pagar</a></li>
                    <li><a asp-controller="Historico" asp-action="Index" data-dismiss="mobile-nav">Extrato</a></li>
                </ul>
            </li>

            <li class="mobile-dropdown">
                <button class="mobile-dropdown-toggle text-warning">Gestão <i class="bi bi-chevron-down"></i></button>
                <ul class="mobile-dropdown-menu">
                    <li><a asp-controller="Relatorios" asp-action="DreGerencial" data-dismiss="mobile-nav">DRE Gerencial</a></li>
                    <li><a asp-controller="ProjecaoFinanceira" asp-action="FluxoDeCaixa" data-dismiss="mobile-nav">Fluxo de Caixa</a></li>
                    <li><a asp-controller="Relatorios" asp-action="Index" data-dismiss="mobile-nav">Relatórios</a></li>
                </ul>
            </li>

            <li class="mobile-dropdown">
                <button class="mobile-dropdown-toggle">Contábil <i class="bi bi-chevron-down"></i></button>
                <ul class="mobile-dropdown-menu">
                    <li><a asp-controller="Categories" asp-action="Index" data-dismiss="mobile-nav">Plano de Contas</a></li>
                    <li><a asp-controller="Budgets" asp-action="Index" data-dismiss="mobile-nav">Centros de Custo</a></li>
                </ul>
            </li>

            <li class="mobile-dropdown">
                <button class="mobile-dropdown-toggle">Cálculos <i class="bi bi-chevron-down"></i></button>
                <ul class="mobile-dropdown-menu">
                    <li><a asp-controller="Ferramentas" asp-action="CalculadoraDeEquilibrio" data-dismiss="mobile-nav">Ponto de Equilíbrio</a></li>
                    <li><a asp-controller="ConversorEnergias" asp-action="Index" data-dismiss="mobile-nav">Custo de Energia</a></li>
                </ul>
            </li>

            @if (User.IsInRole("Administrador"))
            {
                <li><a asp-controller="Usuarios" asp-action="Index" data-dismiss="mobile-nav" class="text-danger">Admin</a></li>
            }
        </ul>
    </nav>

    <button id="header-toggle-tab" class="header-toggle-tab" title="Alternar Menu">
        <i class="bi bi-chevron-up"></i>
    </button>
</header>