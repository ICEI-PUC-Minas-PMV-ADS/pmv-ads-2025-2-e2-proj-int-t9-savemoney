@model savemoney.Models.Usuario

@{
    ViewData["Title"] = "Editar Usuário";
}

<!-- Modal Overlay -->
<div class="modal-overlay" id="editModal">
    <div class="modal-container">

        <!-- Edit Card -->
        <div class="edit-card">

            <!-- Header -->
            <div class="edit-header">
                <div class="header-icon">
                    <span class="material-symbols-outlined" aria-hidden="true">edit</span>
                </div>
                <h2 class="edit-title">Editar Usuário</h2>
                <p class="edit-subtitle">Atualize as informações da conta</p>
            </div>

            <!-- Form -->
            <form asp-action="Edit" id="editForm">
                <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>
                <input type="hidden" asp-for="Id" />
                <input type="hidden" asp-for="DataCadastro" />
                <input type="hidden" asp-for="Perfil" />
                <input type="hidden" asp-for="TipoUsuario" />

                <!-- Nome -->
                <div class="form-group">
                    <label asp-for="Nome" class="form-label">
                        <span class="material-symbols-outlined label-icon" aria-hidden="true">person</span>
                        Nome Completo
                    </label>
                    <input asp-for="Nome" class="form-input" placeholder="Seu nome completo" />
                    <span asp-validation-for="Nome" class="form-error"></span>
                </div>

                <!-- Email (Read-only) -->
                <div class="form-group">
                    <label asp-for="Email" class="form-label">
                        <span class="material-symbols-outlined label-icon" aria-hidden="true">mail</span>
                        Email
                    </label>
                    <div class="form-static">
                        @Model.Email
                    </div>
                    <small class="form-text">O email não pode ser alterado</small>
                </div>

                <!-- Documento -->
                <div class="form-group">
                    <label asp-for="Documento" class="form-label">
                        <span class="material-symbols-outlined label-icon" aria-hidden="true">badge</span>
                        CPF ou CNPJ
                    </label>
                    <input asp-for="Documento" class="form-input" placeholder="000.000.000-00" maxlength="18" />
                    <span asp-validation-for="Documento" class="form-error"></span>
                </div>

                <!-- Senha (OPCIONAL) -->
                <div class="form-group">
                    <label for="Senha" class="form-label">
                        <span class="material-symbols-outlined label-icon" aria-hidden="true">lock</span>
                        Nova Senha (Opcional)
                    </label>
                    <div class="password-wrapper">
                        <input name="Senha"
                               type="password"
                               class="form-input"
                               id="passwordInput"
                               value=""
                               placeholder="Deixe vazio para não alterar" />
                        <button type="button"
                                class="password-toggle"
                                id="togglePassword"
                                aria-label="Mostrar/ocultar senha">
                            <span class="material-symbols-outlined" aria-hidden="true">visibility</span>
                        </button>
                    </div>
                    <small class="form-text">Mínimo 6 caracteres. Deixe em branco para manter a senha atual.</small>
                </div>

                <!-- Perfil (Read-only for users) -->
                @if (User.IsInRole("Administrador"))
                {
                    <div class="form-group">
                        <label asp-for="Perfil" class="form-label">
                            <span class="material-symbols-outlined label-icon" aria-hidden="true">supervisor_account</span>
                            Perfil
                        </label>
                        <select asp-for="Perfil" class="form-input" asp-items="Html.GetEnumSelectList<Perfil>()"></select>
                        <span asp-validation-for="Perfil" class="form-error"></span>
                    </div>
                }
                else
                {
                    <div class="form-group">
                        <label class="form-label">
                            <span class="material-symbols-outlined label-icon" aria-hidden="true">supervisor_account</span>
                            Perfil
                        </label>
                        <div class="form-static">
                            @Model.Perfil
                        </div>
                    </div>
                }

                <!-- Tipo de Usuário (Admin only) -->
                @if (User.IsInRole("Administrador"))
                {
                    <div class="form-group">
                        <label asp-for="TipoUsuario" class="form-label">
                            <span class="material-symbols-outlined label-icon" aria-hidden="true">account_tree</span>
                            Tipo de Usuário
                        </label>
                        <select asp-for="TipoUsuario" class="form-input" asp-items="Html.GetEnumSelectList<TipoUsuario>()"></select>
                        <span asp-validation-for="TipoUsuario" class="form-error"></span>
                    </div>
                }

                <!-- Data de Cadastro (Read-only) -->
                <div class="form-group">
                    <label class="form-label">
                        <span class="material-symbols-outlined label-icon" aria-hidden="true">calendar_today</span>
                        Membro desde
                    </label>
                    <div class="form-static">
                        @Model.DataCadastro.ToString("dd/MM/yyyy 'às' HH:mm")
                    </div>
                </div>

                <!-- Footer Actions -->
                <div class="edit-footer">
                    <button type="submit" class="btn btn-primary">
                        <span class="material-symbols-outlined" aria-hidden="true">save</span>
                        Salvar Alterações
                    </button>

                    @if (User.IsInRole("Administrador"))
                    {
                        <a asp-action="Index" class="btn btn-secondary">
                            <span class="material-symbols-outlined" aria-hidden="true">arrow_back</span>
                            Cancelar
                        </a>
                    }
                    else
                    {
                        <a asp-action="Details" asp-route-id="@Model.Id" class="btn btn-secondary">
                            <span class="material-symbols-outlined" aria-hidden="true">arrow_back</span>
                            Cancelar
                        </a>
                    }
                </div>

            </form>

        </div>

    </div>
</div>

@section css {
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="stylesheet" href="~/css/edit.css" asp-append-version="true" />
}

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script src="~/js/edit.js" asp-append-version="true"></script>
}